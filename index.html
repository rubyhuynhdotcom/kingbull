<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>KINGBULL Việt Nam — Aquafeed B2B Web-App</title>
  <meta name="description" content="Interactive web-app giới thiệu & tư vấn chuyên sâu cho KINGBULL Việt Nam (Aquafeed B2B)" />
  <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'/>" />

  <!-- Tailwind config BEFORE CDN -->
  <script>
    window.tailwind = window.tailwind || {};
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            kb: {
              blue: "#0EA4E8",
              green: "#2BCB53",
              gold: "#FFBE00",
              dark: "#0F172A"
            }
          },
          boxShadow: {
            soft: "0 8px 30px rgba(0,0,0,0.06)"
          }
        }
      }
    }
  </script>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <style>
    :root{
      --kb-blue:#0EA4E8;
      --kb-green:#2BCB53;
      --kb-gold:#FFBE00;
    }
    .brand-gradient {
      background: radial-gradient(1200px 400px at 20% -10%, rgba(14,164,232,.18), transparent 50%),
                  radial-gradient(800px 300px at 90% 10%, rgba(43,203,83,.14), transparent 60%),
                  linear-gradient(180deg, #ffffff, #f8fafc 60%, #f1f5f9);
    }
    .kb-focus:focus-visible{
      outline: 3px solid var(--kb-blue);
      outline-offset: 2px;
      border-radius: .5rem;
    }
    /* Fix Leaflet container size in our section */
    #kb-map { min-height: 420px; border-radius: 1rem; }
  </style>
</head>
<body class="bg-white text-slate-900 antialiased">
  <a href="#main" class="sr-only focus:not-sr-only kb-focus absolute top-2 left-2 bg-white px-3 py-1 rounded shadow">
    Bỏ qua đến nội dung chính
  </a>

  <div id="root"></div>

  <!-- React + ReactDOM + Babel -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Framer Motion UMD -->
  <script src="https://unpkg.com/framer-motion@11.0.8/dist/framer-motion.umd.js"></script>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <!-- APP -->
  <script type="text/babel">
    const { useState, useMemo, useEffect, useRef } = React;
    const { motion, AnimatePresence } = window.framerMotion;

    /** --------------------------
     * Brand & common components
     * -------------------------- */
    const Container = ({children, id}) => (
      <section id={id} className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">{children}</section>
    );

    const SectionTitle = ({title, subtitle}) => (
      <div className="mb-8">
        <h2 className="text-2xl sm:text-3xl font-extrabold tracking-tight">
          <span className="text-kb-blue">|</span> {title}
        </h2>
        {subtitle && <p className="text-slate-600 mt-2">{subtitle}</p>}
      </div>
    );

    const Pill = ({children}) => (
      <span className="inline-block text-xs font-semibold px-2 py-1 rounded-full bg-slate-100 text-slate-700">{children}</span>
    );

    const Stat = ({label, value}) => (
      <div className="p-4 rounded-xl bg-white shadow-soft border border-slate-100">
        <div className="text-xs uppercase tracking-wide text-slate-500">{label}</div>
        <div className="text-xl font-bold mt-1">{value}</div>
      </div>
    );

    /** --------------------------
     * Data (dummy)
     * -------------------------- */
    const COMPANY = {
      name: "CÔNG TY TNHH KINGBULL VIỆT NAM",
      tax: "1801608521",
      address: "Tầng 6, số 41, Cách Mạng Tháng Tám, Phường Cái Khế, TP Cần Thơ, Việt Nam",
      email: "admin@kingbull.com.vn",
      phone: "0587085649",
      slogan: "Đột phá tăng trưởng, dẫn đầu lợi nhuận",
      hotlineLink: "tel:+84587085649",
      zaloLink: "https://zalo.me/0587085649"
    };

    const TABS = [
      { key: "home", label: "Home" },
      { key: "cases", label: "Case Study" },
      { key: "library", label: "Thư viện PDF" },
      { key: "videos", label: "Video Nhà máy" },
      { key: "dealer", label: "Dành cho Đại lý" },
      { key: "map", label: "Bản đồ Năng lực" },
      { key: "support", label: "Hỗ trợ 24/7" },
      { key: "logistics", label: "Tính Logistics" },
      { key: "news", label: "Tin tức & Phân tích" },
      { key: "rd", label: "Hợp tác R&D" }
    ];

    const CASE_STUDIES = [
      {
        id: 1, name: "Ao nuôi cá tra A1 - Cần Thơ", species: "Cá tra",
        areaHa: 5, cycleDays: 180, harvestTons: 600, fcr: 1.5,
        feedCostPerKg: 12000, pricePerKg: 25000,
        started: "2024-03-01", finished: "2024-08-30",
        images: ["https://images.unsplash.com/photo-1593262109328-154f3fb9d29f?q=80&w=1200&auto=format&fit=crop"],
        video: "https://www.youtube.com/embed/1La4QzGeaaQ",
        ownerNote: "Thức ăn ổn định, tăng trưởng đồng đều, tỷ lệ sống cao.",
      },
      {
        id: 2, name: "Mô hình cá rô phi siêu thâm canh - Long An", species: "Cá rô phi",
        areaHa: 2.5, cycleDays: 150, harvestTons: 220, fcr: 1.35,
        feedCostPerKg: 11500, pricePerKg: 32000,
        started: "2024-02-15", finished: "2024-07-20",
        images: ["https://images.unsplash.com/photo-1576765608610-5f4e01aa12c4?q=80&w=1200&auto=format&fit=crop"],
        video: "https://www.youtube.com/embed/aqz-KE-bpKQ",
        ownerNote: "Tối ưu FCR, giảm hao hụt nhờ quản trị nước tốt.",
      },
      {
        id: 3, name: "Cá lóc thương phẩm - An Giang", species: "Cá lóc",
        areaHa: 1.2, cycleDays: 120, harvestTons: 95, fcr: 1.6,
        feedCostPerKg: 12500, pricePerKg: 38000,
        started: "2024-04-10", finished: "2024-08-10",
        images: ["https://images.unsplash.com/photo-1517837016564-bfcf7a7c89d6?q=80&w=1200&auto=format&fit=crop"],
        video: "https://www.youtube.com/embed/oUFJJNQGwhk",
        ownerNote: "Tăng trưởng nhanh, màu thịt đẹp, đầu ra ổn định.",
      }
    ];

    const PDF_LIBRARY = [
      { id: "pdf1", title: "Tối ưu FCR theo giai đoạn", species: "Cá tra", stage: "Tăng trưởng", goal: "Tối ưu chi phí",
        url: "https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf" },
      { id: "pdf2", title: "Phòng bệnh thường gặp mùa mưa", species: "Cá rô phi", stage: "Phòng bệnh", goal: "An toàn sinh học",
        url: "https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf" },
      { id: "pdf3", title: "Quản lý môi trường nước ao đất", species: "Cá lóc", stage: "Môi trường", goal: "Ổn định năng suất",
        url: "https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf" },
      { id: "pdf4", title: "Tối ưu vòng quay vốn (360°)", species: "Cá tra", stage: "Tài chính", goal: "Tối ưu vốn",
        url: "https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf" }
    ];

    const VIDEO_GALLERY = [
      { id:"v1", title:"Flycam toàn cảnh nhà máy", src:"https://www.youtube.com/embed/1La4QzGeaaQ" },
      { id:"v2", title:"Dây chuyền sản xuất tự động", src:"https://www.youtube.com/embed/aqz-KE-bpKQ" },
      { id:"v3", title:"Kho lạnh & container xuất", src:"https://www.youtube.com/embed/oUFJJNQGwhk" }
    ];

    const WAREHOUSES = [
      { id:"dc1", name:"Cần Thơ DC", region:"ĐBSCL", lat:10.045, lng:105.746 },
      { id:"dc2", name:"Long An DC", region:"ĐBSCL", lat:10.695, lng:106.242 },
      { id:"dc3", name:"Hồ Chí Minh Hub", region:"Miền Nam", lat:10.823, lng:106.629 },
      { id:"dc4", name:"Nha Trang Node", region:"Miền Trung", lat:12.238, lng:109.196 },
      { id:"dc5", name:"Hải Phòng Port", region:"Miền Bắc", lat:20.861, lng:106.683 }
    ];

    const DESTINATIONS = [
      { id:"dst1", name:"An Giang (cá tra)", region:"ĐBSCL", lat:10.375, lng:105.420 },
      { id:"dst2", name:"Bạc Liêu (tôm/cá)", region:"ĐBSCL", lat:9.294, lng:105.727 },
      { id:"dst3", name:"Cà Mau (tôm/cá)", region:"ĐBSCL", lat:9.176, lng:105.152 },
      { id:"dst4", name:"Quảng Nam (cá rô phi)", region:"Miền Trung", lat:15.573, lng:108.474 },
      { id:"dst5", name:"Hải Dương (cá lóc)", region:"Miền Bắc", lat:20.938, lng:106.320 }
    ];

    const NEWS = [
      { id:"n1", tag:"Giá nguyên liệu", title:"Bột cá ổn định, dầu đậu nành tăng nhẹ",
        date:"2025-07-28", excerpt:"Giá dầu đậu nành tăng 2.1% do nguồn cung thắt chặt; bột cá giữ mức ổn định theo quý." },
      { id:"n2", tag:"Xuất khẩu", title:"Nhu cầu thị trường Trung Đông tăng",
        date:"2025-07-15", excerpt:"Các nhà nhập khẩu tăng đơn hàng dòng premium; yêu cầu chứng nhận truy xuất nguồn gốc rõ ràng." },
      { id:"n3", tag:"Dịch bệnh", title:"Cảnh báo Vibrio vùng ven biển miền Trung",
        date:"2025-06-30", excerpt:"Khuyến nghị tăng cường sát trùng, quản trị tảo, bổ sung probiotics trong giai đoạn chuyển mùa." }
    ];

    /** --------------------------
     * Utils
     * -------------------------- */
    const currencyVND = n => n.toLocaleString("vi-VN") + " ₫";
    const ceil = Math.ceil;

    // Haversine for distance (km)
    const distanceKm = (a, b) => {
      const toRad = deg => (deg*Math.PI)/180;
      const R = 6371;
      const dLat = toRad(b.lat - a.lat);
      const dLng = toRad(b.lng - a.lng);
      const s1 = Math.sin(dLat/2)**2 +
                 Math.cos(toRad(a.lat))*Math.cos(toRad(b.lat))*Math.sin(dLng/2)**2;
      const c = 2*Math.atan2(Math.sqrt(s1), Math.sqrt(1-s1));
      return R*c;
    };

    /** --------------------------
     * Navbar (sticky + SPA tabs)
     * -------------------------- */
    const Navbar = ({active, onChange}) => {
      return (
        <nav className="sticky top-0 z-40 bg-white/80 backdrop-blur border-b border-slate-100">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div className="flex items-center gap-3">
              <div className="text-2xl font-extrabold tracking-wider" aria-label="KINGBULL logo text">
                <span className="text-kb-blue">KING</span><span className="text-kb-green">BULL</span>
              </div>
              <span className="hidden sm:inline-block text-sm text-slate-500">“Đột phá tăng trưởng, dẫn đầu lợi nhuận”</span>
            </div>
            <ul className="hidden lg:flex items-center gap-1">
              {TABS.map(t => (
                <li key={t.key}>
                  <button
                    className={"px-3 py-2 rounded-lg text-sm font-medium kb-focus " + (active===t.key ? "bg-kb-blue text-white" : "hover:bg-slate-100")}
                    onClick={() => onChange(t.key)}
                    aria-current={active===t.key ? "page" : undefined}
                  >
                    {t.label}
                  </button>
                </li>
              ))}
            </ul>
            <div className="lg:hidden">
              <select
                className="kb-focus border rounded-lg px-2 py-2"
                value={active}
                aria-label="Chọn mục"
                onChange={e => onChange(e.target.value)}
              >
                {TABS.map(t => <option key={t.key} value={t.key}>{t.label}</option>)}
              </select>
            </div>
          </div>
        </nav>
      );
    };

    /** --------------------------
     * Hero (Home)
     * -------------------------- */
    const Hero = ({onSeeCases, onContact}) => {
      return (
        <div className="brand-gradient">
          <Container id="home-hero">
            <div className="grid lg:grid-cols-2 gap-8 items-center">
              <motion.div
                initial={{opacity:0, y:20}}
                animate={{opacity:1, y:0}}
                transition={{duration:.6}}
              >
                <Pill> Aquafeed B2B • Việt Nam </Pill>
                <h1 className="text-3xl sm:text-5xl font-black leading-tight mt-3">
                  KINGBULL — <span className="text-kb-blue">Chuyên nghiệp</span>, <span className="text-kb-green">Tin cậy</span>, <span className="text-kb-gold">Hướng kết quả</span>
                </h1>
                <p className="text-slate-600 mt-4 max-w-xl">
                  Năng lực sản xuất & cung ứng quy mô lớn, tối ưu lợi nhuận cho đại lý và trang trại nuôi quy mô.
                </p>

                <div className="mt-6 flex flex-wrap gap-3">
                  <button onClick={onSeeCases} className="kb-focus bg-kb-blue text-white px-4 py-2 rounded-xl shadow-soft">
                    Xem Hồ sơ Dự án Thành công
                  </button>
                  <button onClick={onContact} className="kb-focus px-4 py-2 rounded-xl border border-slate-200">
                    Liên hệ Hợp tác
                  </button>
                </div>

                <div className="grid grid-cols-3 gap-3 mt-8">
                  <Stat label="Năng lực cung ứng" value="> 100.000 tấn/năm" />
                  <Stat label="Mạng lưới phân phối" value="63 tỉnh thành" />
                  <Stat label="Hỗ trợ kỹ thuật" value="24/7" />
                </div>
              </motion.div>

              <motion.div
                initial={{opacity:0, scale:.98}}
                animate={{opacity:1, scale:1}}
                transition={{duration:.6, delay:.1}}
                className="rounded-2xl overflow-hidden shadow-soft border border-slate-100 bg-black"
              >
                <div className="aspect-video">
                  <iframe
                    title="Flycam nhà máy"
                    src="https://www.youtube.com/embed/1La4QzGeaaQ"
                    className="w-full h-full"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    allowFullScreen
                  ></iframe>
                </div>
              </motion.div>
            </div>

            <div className="mt-10 grid sm:grid-cols-3 gap-4">
              <div className="p-4 rounded-xl bg-white shadow-soft border border-slate-100">
                <h3 className="font-bold">Năng lực cung ứng lớn</h3>
                <p className="text-sm text-slate-600 mt-1">Chuỗi sản xuất – kho – logistics đồng bộ, giao nhanh đúng hẹn.</p>
              </div>
              <div className="p-4 rounded-xl bg-white shadow-soft border border-slate-100">
                <h3 className="font-bold">Tối ưu lợi nhuận</h3>
                <p className="text-sm text-slate-600 mt-1">Công thức dinh dưỡng theo ROI, tối ưu FCR và vòng quay vốn.</p>
              </div>
              <div className="p-4 rounded-xl bg-white shadow-soft border border-slate-100">
                <h3 className="font-bold">Hỗ trợ kỹ thuật 24/7</h3>
                <p className="text-sm text-slate-600 mt-1">Đội ngũ kỹ thuật theo khu vực, phản hồi nhanh, onsite khi cần.</p>
              </div>
            </div>
          </Container>
        </div>
      );
    };

    /** --------------------------
     * Case Studies
     * -------------------------- */
    const CaseStudyCard = ({item, onOpen}) => {
      const revenue = item.harvestTons * 1000 * item.pricePerKg;
      const feedCost = item.harvestTons * 1000 * item.fcr * item.feedCostPerKg;
      const net = revenue - feedCost;
      const roi = net / feedCost;

      return (
        <div className="rounded-2xl overflow-hidden bg-white border border-slate-100 shadow-soft">
          <div className="aspect-video bg-slate-100">
            <img src={item.images[0]} alt={`Ảnh ao nuôi - ${item.name}`} className="w-full h-full object-cover" />
          </div>
          <div className="p-4">
            <div className="flex items-center justify-between gap-2">
              <h3 className="font-bold text-lg">{item.name}</h3>
              <Pill>{item.species}</Pill>
            </div>
            <div className="grid grid-cols-2 sm:grid-cols-4 gap-2 mt-3 text-sm">
              <div className="p-2 rounded-lg bg-slate-50">Diện tích: <b>{item.areaHa} ha</b></div>
              <div className="p-2 rounded-lg bg-slate-50">Chu kỳ: <b>{item.cycleDays} ngày</b></div>
              <div className="p-2 rounded-lg bg-slate-50">Sản lượng: <b>{item.harvestTons} tấn</b></div>
              <div className="p-2 rounded-lg bg-slate-50">FCR: <b>{item.fcr}</b></div>
            </div>
            <div className="grid grid-cols-3 gap-2 mt-3 text-sm">
              <div className="p-2 rounded-lg bg-slate-50">Doanh thu: <b>{currencyVND(revenue)}</b></div>
              <div className="p-2 rounded-lg bg-slate-50">Chi phí thức ăn: <b>{currencyVND(feedCost)}</b></div>
              <div className="p-2 rounded-lg bg-slate-50">ROI: <b>{(roi*100).toFixed(1)}%</b></div>
            </div>
            <button onClick={()=>onOpen(item)} className="kb-focus mt-3 w-full bg-kb-blue text-white py-2 rounded-xl">Xem chi tiết</button>
          </div>
        </div>
      );
    };

    const CaseStudyDetail = ({item, onClose}) => {
      if(!item) return null;
      const revenue = item.harvestTons * 1000 * item.pricePerKg;
      const feedCost = item.harvestTons * 1000 * item.fcr * item.feedCostPerKg;
      const net = revenue - feedCost;
      const roi = net / feedCost;
      return (
        <div role="dialog" aria-modal="true" className="fixed inset-0 z-50">
          <div className="absolute inset-0 bg-black/40" onClick={onClose} aria-hidden="true"></div>
          <div className="absolute inset-x-0 top-10 mx-auto max-w-4xl">
            <motion.div
              initial={{opacity:0, y:20}} animate={{opacity:1, y:0}} transition={{duration:.25}}
              className="bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden"
            >
              <div className="flex items-center justify-between p-4 border-b">
                <div>
                  <h3 className="font-bold text-xl">{item.name}</h3>
                  <p className="text-sm text-slate-500">{item.species} • {item.started} → {item.finished}</p>
                </div>
                <button className="kb-focus px-3 py-1 rounded-lg border" onClick={onClose} aria-label="Đóng">Đóng</button>
              </div>
              <div className="grid lg:grid-cols-2 gap-0">
                <div className="aspect-video bg-black">
                  <iframe title={"Video - " + item.name} src={item.video} className="w-full h-full" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowFullScreen></iframe>
                </div>
                <div className="p-4">
                  <p className="text-slate-700">{item.ownerNote}</p>
                  <div className="grid grid-cols-2 gap-3 mt-4">
                    <Stat label="Doanh thu" value={currencyVND(revenue)} />
                    <Stat label="Chi phí thức ăn" value={currencyVND(feedCost)} />
                    <Stat label="Lợi nhuận (ước)" value={currencyVND(net)} />
                    <Stat label="ROI" value={(roi*100).toFixed(1) + "%"} />
                  </div>
                  <div className="mt-4">
                    <h4 className="font-semibold">Ghi chú kỹ thuật</h4>
                    <ul className="list-disc list-inside text-sm text-slate-600 mt-2">
                      <li>Quản trị oxy hòa tan > 5 mg/L, cho ăn theo đường cong tăng trưởng.</li>
                      <li>Tối ưu FCR theo cỡ cá, bổ sung enzymes & probiotics khi chuyển cỡ.</li>
                      <li>Theo dõi NH₃/NH₄⁺, NO₂⁻, độ kiềm 80–120 mg/L.</li>
                    </ul>
                  </div>
                </div>
              </div>
            </motion.div>
          </div>
        </div>
      );
    };

    const CaseStudies = () => {
      const [detail, setDetail] = useState(null);
      const [filter, setFilter] = useState("Tất cả");
      const speciesList = ["Tất cả", ...Array.from(new Set(CASE_STUDIES.map(c => c.species)))];
      const filtered = CASE_STUDIES.filter(c => filter==="Tất cả" ? true : c.species===filter);
      return (
        <Container id="cases">
          <SectionTitle title="Hồ sơ dự án nuôi thành công" subtitle="Dữ liệu ROI minh bạch — video, hình ảnh & nhận xét chủ trại" />
          <div className="flex items-center gap-3 mb-5">
            <label className="text-sm">Loài nuôi</label>
            <select className="kb-focus border rounded-lg px-3 py-2" value={filter} onChange={e=>setFilter(e.target.value)} aria-label="Lọc theo loài">
              {speciesList.map(s => <option key={s}>{s}</option>)}
            </select>
          </div>
          <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
            {filtered.map(item => <CaseStudyCard key={item.id} item={item} onOpen={setDetail} />)}
          </div>
          <AnimatePresence>{detail && <CaseStudyDetail item={detail} onClose={()=>setDetail(null)} />}</AnimatePresence>
        </Container>
      );
    };

    /** --------------------------
     * PDF Library (filters)
     * -------------------------- */
    const PDFLibrary = () => {
      const [species, setSpecies] = useState("Tất cả");
      const [stage, setStage] = useState("Tất cả");
      const [goal, setGoal] = useState("Tất cả");

      const speciesList = ["Tất cả", ...Array.from(new Set(PDF_LIBRARY.map(x=>x.species)))];
      const stageList   = ["Tất cả", ...Array.from(new Set(PDF_LIBRARY.map(x=>x.stage)))];
      const goalList    = ["Tất cả", ...Array.from(new Set(PDF_LIBRARY.map(x=>x.goal)))];

      const filtered = PDF_LIBRARY.filter(x =>
        (species==="Tất cả" || x.species===species) &&
        (stage==="Tất cả"   || x.stage===stage) &&
        (goal==="Tất cả"    || x.goal===goal)
      );

      return (
        <Container id="library">
          <SectionTitle title="Thư viện kỹ thuật chuyên sâu" subtitle="Bài viết PDF về FCR, phòng bệnh, môi trường nước, vòng quay vốn" />
          <div className="flex flex-wrap items-center gap-3 mb-6">
            <Select label="Loài" value={species} setValue={setSpecies} options={speciesList} />
            <Select label="Giai đoạn" value={stage} setValue={setStage} options={stageList} />
            <Select label="Mục tiêu" value={goal} setValue={setGoal} options={goalList} />
          </div>
          <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
            {filtered.map(x=>(
              <div key={x.id} className="p-4 rounded-2xl bg-white border border-slate-100 shadow-soft">
                <h3 className="font-semibold">{x.title}</h3>
                <div className="flex flex-wrap gap-2 mt-2">
                  <Pill>{x.species}</Pill>
                  <Pill>{x.stage}</Pill>
                  <Pill>{x.goal}</Pill>
                </div>
                <a className="kb-focus mt-4 inline-block bg-kb-blue text-white px-3 py-2 rounded-lg"
                   href={x.url} target="_blank" rel="noreferrer" download>
                  Tải PDF
                </a>
              </div>
            ))}
          </div>
        </Container>
      );
    };

    const Select = ({label, value, setValue, options}) => (
      <label className="text-sm">
        <span className="mr-2 text-slate-600">{label}</span>
        <select className="kb-focus border rounded-lg px-3 py-2" value={value} onChange={e=>setValue(e.target.value)}>
          {options.map(o => <option key={o}>{o}</option>)}
        </select>
      </label>
    );

    /** --------------------------
     * Video Section
     * -------------------------- */
    const VideoSection = () => (
      <Container id="videos">
        <SectionTitle title="Video quy trình sản xuất & năng lực nhà máy" />
        <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
          {VIDEO_GALLERY.map(v=>(
            <div key={v.id} className="rounded-2xl overflow-hidden bg-black shadow-soft border border-slate-200">
              <div className="aspect-video">
                <iframe title={v.title} src={v.src} className="w-full h-full" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowFullScreen></iframe>
              </div>
              <div className="p-3 bg-white">
                <h3 className="font-semibold">{v.title}</h3>
              </div>
            </div>
          ))}
        </div>
        <div className="mt-6 grid grid-cols-2 sm:grid-cols-4 gap-3">
          <img className="rounded-xl w-full h-28 object-cover" alt="Kho lạnh" src="https://images.unsplash.com/photo-1541911087797-f89237bd95d6?q=80&w=1200&auto=format&fit=crop" />
          <img className="rounded-xl w-full h-28 object-cover" alt="Container xuất hàng" src="https://images.unsplash.com/photo-1544989164-31dc3c645987?q=80&w=1200&auto=format&fit=crop" />
          <img className="rounded-xl w-full h-28 object-cover" alt="Kiểm định chất lượng" src="https://images.unsplash.com/photo-1581090700227-1e37b190418e?q=80&w=1200&auto=format&fit=crop" />
          <img className="rounded-xl w-full h-28 object-cover" alt="Dây chuyền sản xuất" src="https://images.unsplash.com/photo-1581093588401-a1b1a1c5381e?q=80&w=1200&auto=format&fit=crop" />
        </div>
      </Container>
    );

    /** --------------------------
     * Dealer Portal (mock login)
     * -------------------------- */
    const DealerPortal = () => {
      const [logged, setLogged] = useState(false);
      const [email, setEmail] = useState("");
      const [code, setCode] = useState("");
      const [msg, setMsg] = useState("");

      const submit = e => {
        e.preventDefault();
        if(code.trim().toUpperCase() === "KINGBULL2025" && email.includes("@")){
          setLogged(true);
          setMsg("");
        } else {
          setMsg("Mã truy cập hoặc email không hợp lệ.");
        }
      };

      return (
        <Container id="dealer">
          <SectionTitle title="Khu vực Dành cho Đại lý & Trang trại" subtitle="Bảo vệ nội dung bằng đăng nhập mock" />
          {!logged ? (
            <form onSubmit={submit} className="max-w-lg p-6 rounded-2xl bg-white border border-slate-200 shadow-soft">
              <label className="block mb-4">
                <span className="text-sm text-slate-600">Email</span>
                <input required type="email" value={email} onChange={e=>setEmail(e.target.value)} className="kb-focus mt-1 w-full border rounded-lg px-3 py-2" placeholder="you@company.com" />
              </label>
              <label className="block mb-4">
                <span className="text-sm text-slate-600">Mã truy cập</span>
                <input required type="password" value={code} onChange={e=>setCode(e.target.value)} className="kb-focus mt-1 w-full border rounded-lg px-3 py-2" placeholder="KINGBULL2025" />
              </label>
              {msg && <p className="text-sm text-red-600 mb-3">{msg}</p>}
              <button className="kb-focus bg-kb-blue text-white px-4 py-2 rounded-xl">Đăng nhập</button>
            </form>
          ) : (
            <div className="grid md:grid-cols-2 gap-6">
              <div className="p-5 rounded-2xl bg-white border border-slate-200 shadow-soft">
                <h3 className="font-bold">Tài liệu nội bộ</h3>
                <ul className="list-disc list-inside text-sm mt-2">
                  <li><a className="text-kb-blue underline" href="https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf" target="_blank" rel="noreferrer">Bảng giá số lượng lớn (PDF)</a></li>
                  <li><a className="text-kb-blue underline" href="https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf" target="_blank" rel="noreferrer">Chính sách chiết khấu (PDF)</a></li>
                  <li><a className="text-kb-blue underline" href="https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf" target="_blank" rel="noreferrer">Tài liệu huấn luyện kỹ thuật (PDF)</a></li>
                </ul>
              </div>
              <div className="p-5 rounded-2xl bg-white border border-slate-200 shadow-soft">
                <h3 className="font-bold">Video Training</h3>
                <ul className="list-disc list-inside text-sm mt-2">
                  <li><a className="text-kb-blue underline" href="https://www.youtube.com/watch?v=aqz-KE-bpKQ" target="_blank" rel="noreferrer">Quy trình phối trộn & kiểm soát chất lượng</a></li>
                  <li><a className="text-kb-blue underline" href="https://www.youtube.com/watch?v=oUFJJNQGwhk" target="_blank" rel="noreferrer">Vận hành kho lạnh & an toàn</a></li>
                </ul>
              </div>
            </div>
          )}
        </Container>
      );
    };

    /** --------------------------
     * Map Supply (Leaflet + filter)
     * -------------------------- */
    const MapSupply = () => {
      const mapRef = useRef(null);
      const layerRef = useRef(null);
      const [region, setRegion] = useState("Tất cả");

      useEffect(()=>{
        if(!mapRef.current){
          const map = L.map('kb-map', { zoomControl: true }).setView([10.5, 106], 6);
          L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; OpenStreetMap'
          }).addTo(map);
          mapRef.current = map;
        }
      },[]);

      useEffect(()=>{
        // clear old
        if(layerRef.current){
          layerRef.current.clearLayers();
        } else {
          layerRef.current = L.layerGroup().addTo(mapRef.current);
        }

        // warehouses
        WAREHOUSES
          .filter(w => region==="Tất cả" ? true : w.region===region)
          .forEach(w=>{
            const mk = L.marker([w.lat, w.lng]).addTo(layerRef.current);
            mk.bindPopup(`<b>${w.name}</b><br/>Khu vực: ${w.region}`);
          });

        // destinations
        DESTINATIONS
          .filter(d => region==="Tất cả" ? true : d.region===region)
          .forEach(d=>{
            const mk = L.circleMarker([d.lat, d.lng], { radius:8, color:"#0EA4E8" }).addTo(layerRef.current);
            mk.bindPopup(`<b>${d.name}</b><br/>Khu vực: ${d.region}`);
          });
      },[region]);

      return (
        <Container id="map">
          <SectionTitle title="Bản đồ năng lực cung ứng" subtitle="Vùng phân phối, kho bãi, thời gian giao hàng ước tính" />
          <div className="flex items-center gap-3 mb-4">
            <label className="text-sm">Khu vực</label>
            <select className="kb-focus border rounded-lg px-3 py-2" value={region} onChange={e=>setRegion(e.target.value)}>
              <option>Tất cả</option>
              <option>ĐBSCL</option>
              <option>Miền Nam</option>
              <option>Miền Trung</option>
              <option>Miền Bắc</option>
            </select>
          </div>
          <div id="kb-map" role="img" aria-label="Bản đồ năng lực cung ứng"></div>
          <p className="text-xs text-slate-500 mt-2">Thời gian giao hàng phụ thuộc điều kiện vận tải; dữ liệu mang tính mô phỏng.</p>
        </Container>
      );
    };

    /** --------------------------
     * Support 24/7
     * -------------------------- */
    const SupportPanel = () => {
      const [form, setForm] = useState({name:"", phone:"", region:"", note:""});
      const [ok, setOk] = useState(false);
      const submit = e => { e.preventDefault(); setOk(true); };
      return (
        <Container id="support">
          <SectionTitle title="Hỗ trợ kỹ thuật 24/7" />
          <div className="grid md:grid-cols-3 gap-6">
            <div className="p-5 rounded-2xl bg-white border border-slate-200 shadow-soft">
              <h3 className="font-bold mb-2">Liên hệ nhanh</h3>
              <a className="kb-focus block bg-kb-blue text-white text-center px-4 py-2 rounded-xl mb-2" href={COMPANY.hotlineLink}>Gọi Hotline kỹ thuật</a>
              <a className="kb-focus block bg-slate-100 text-slate-800 text-center px-4 py-2 rounded-xl mb-2" href={COMPANY.zaloLink} target="_blank" rel="noreferrer">Chat Zalo OA</a>
              <a className="kb-focus block bg-white border text-center px-4 py-2 rounded-xl" href={"mailto:" + COMPANY.email}>Gửi Email</a>
              <div className="mt-4 text-sm text-slate-600">
                <p><b>Địa chỉ: </b>{COMPANY.address}</p>
                <p><b>Điện thoại: </b>0{COMPANY.phone}</p>
                <p><b>Email: </b>{COMPANY.email}</p>
              </div>
            </div>
            <form onSubmit={submit} className="md:col-span-2 p-5 rounded-2xl bg-white border border-slate-200 shadow-soft">
              <h3 className="font-bold mb-2">Đặt lịch hẹn với chuyên gia</h3>
              <div className="grid sm:grid-cols-2 gap-4">
                <label className="text-sm">Họ tên
                  <input required className="kb-focus mt-1 w-full border rounded-lg px-3 py-2" value={form.name} onChange={e=>setForm({...form, name:e.target.value})}/>
                </label>
                <label className="text-sm">Số điện thoại
                  <input required className="kb-focus mt-1 w-full border rounded-lg px-3 py-2" value={form.phone} onChange={e=>setForm({...form, phone:e.target.value})}/>
                </label>
                <label className="text-sm">Khu vực
                  <select required className="kb-focus mt-1 w-full border rounded-lg px-3 py-2" value={form.region} onChange={e=>setForm({...form, region:e.target.value})}>
                    <option value="">Chọn</option>
                    <option>ĐBSCL</option><option>Miền Nam</option><option>Miền Trung</option><option>Miền Bắc</option>
                  </select>
                </label>
                <label className="text-sm">Ghi chú
                  <input className="kb-focus mt-1 w-full border rounded-lg px-3 py-2" value={form.note} onChange={e=>setForm({...form, note:e.target.value})}/>
                </label>
              </div>
              <button className="kb-focus mt-4 bg-kb-green text-white px-4 py-2 rounded-xl">Đặt lịch</button>
              {ok && <p className="text-sm text-kb-blue mt-2">Đã nhận yêu cầu! Kỹ thuật viên khu vực sẽ liên hệ sớm.</p>}
            </form>
          </div>
        </Container>
      );
    };

    /** --------------------------
     * Logistics Calculator
     * -------------------------- */
    const LogisticsCalc = () => {
      const [qtyTon, setQtyTon] = useState(50);
      const [destId, setDestId] = useState(DESTINATIONS[0].id);
      const [result, setResult] = useState(null);

      const calc = e => {
        e.preventDefault();
        const dest = DESTINATIONS.find(d => d.id===destId);
        // Find nearest warehouse by distance
        let best = null, bestD = Infinity;
        WAREHOUSES.forEach(w=>{
          const d = distanceKm({lat:w.lat,lng:w.lng}, {lat:dest.lat,lng:dest.lng});
          if(d<bestD){bestD=d; best=w;}
        });
        // Params
        const capacityPerContainerTon = 25;
        const trips = ceil(qtyTon / capacityPerContainerTon);
        // Speed & time (rough): 45 km/h trucking + 2h handling
        const hours = bestD / 45 + 2;
        const etaDays = Math.max(1, Math.round(hours/8)); // working hours/day
        setResult({
          dc: best.name, region: best.region,
          distanceKm: Math.round(bestD),
          trips, etaDays
        });
      };

      return (
        <Container id="logistics">
          <SectionTitle title="Công cụ Tính Logistics & Kho Bãi" subtitle="Mô phỏng số chuyến container & thời gian giao hàng" />
          <form onSubmit={calc} className="p-5 rounded-2xl bg-white border border-slate-200 shadow-soft max-w-3xl">
            <div className="grid sm:grid-cols-3 gap-4">
              <label className="text-sm">Số lượng (tấn)
                <input type="number" min="1" className="kb-focus mt-1 w-full border rounded-lg px-3 py-2" value={qtyTon} onChange={e=>setQtyTon(Number(e.target.value||0))}/>
              </label>
              <label className="text-sm">Địa điểm giao
                <select className="kb-focus mt-1 w-full border rounded-lg px-3 py-2" value={destId} onChange={e=>setDestId(e.target.value)}>
                  {DESTINATIONS.map(d=> <option key={d.id} value={d.id}>{d.name}</option>)}
                </select>
              </label>
              <div className="self-end">
                <button className="kb-focus w-full bg-kb-blue text-white px-4 py-2 rounded-xl">Tính mô phỏng</button>
              </div>
            </div>
            {result && (
              <div className="grid sm:grid-cols-4 gap-3 mt-5">
                <Stat label="Kho xuất phát" value={result.dc} />
                <Stat label="Khu vực kho" value={result.region} />
                <Stat label="Khoảng cách (km)" value={result.distanceKm} />
                <Stat label="Số chuyến (ước)" value={result.trips} />
                <Stat label="Thời gian giao (ngày)" value={result.etaDays} />
              </div>
            )}
          </form>
        </Container>
      );
    };

    /** --------------------------
     * News
     * -------------------------- */
    const NewsCard = ({item}) => (
      <div className="p-4 rounded-2xl bg-white border border-slate-200 shadow-soft">
        <div className="flex items-center justify-between">
          <Pill>{item.tag}</Pill>
          <span className="text-xs text-slate-500">{item.date}</span>
        </div>
        <h3 className="font-semibold mt-2">{item.title}</h3>
        <p className="text-sm text-slate-600 mt-1">{item.excerpt}</p>
      </div>
    );

    const News = () => {
      const [tag, setTag] = useState("Tất cả");
      const tags = ["Tất cả", ...Array.from(new Set(NEWS.map(n=>n.tag)))];
      const filtered = NEWS.filter(n => tag==="Tất cả" ? true : n.tag===tag);
      return (
        <Container id="news">
          <SectionTitle title="Tin tức ngành & phân tích thị trường" subtitle="Cập nhật giá nguyên liệu, xu hướng xuất khẩu, dịch bệnh thủy sản" />
          <div className="flex items-center gap-3 mb-5">
            <label className="text-sm">Chủ đề</label>
            <select className="kb-focus border rounded-lg px-3 py-2" value={tag} onChange={e=>setTag(e.target.value)}>
              {tags.map(t=><option key={t}>{t}</option>)}
            </select>
          </div>
          <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
            {filtered.map(n => <NewsCard key={n.id} item={n} />)}
          </div>
        </Container>
      );
    };

    /** --------------------------
     * R&D section
     * -------------------------- */
    const RDSection = () => {
      const [sent, setSent] = useState(false);
      const [f, setF] = useState({org:"", contact:"", proposal:""});
      const submit = e => { e.preventDefault(); setSent(true); };
      return (
        <Container id="rd">
          <SectionTitle title="Chương trình hợp tác R&D" subtitle="Viện nghiên cứu, trường đại học, trại nuôi thử nghiệm" />
          <div className="grid md:grid-cols-2 gap-6">
            <div className="p-5 rounded-2xl bg-white border border-slate-200 shadow-soft">
              <h3 className="font-bold mb-2">Giới thiệu</h3>
              <p className="text-sm text-slate-600">
                KINGBULL sẵn sàng đồng hành triển khai dự án R&D về dinh dưỡng, công nghệ quy trình, sinh học môi trường và tối ưu tài chính.
              </p>
              <ul className="list-disc list-inside text-sm text-slate-600 mt-3">
                <li>Đồng phát triển công thức cho từng loài/giai đoạn.</li>
                <li>Thử nghiệm thực địa có giám sát KPI rõ ràng.</li>
                <li>Chia sẻ dữ liệu (ẩn danh) và công bố khoa học.</li>
              </ul>
            </div>
            <form onSubmit={submit} className="p-5 rounded-2xl bg-white border border-slate-200 shadow-soft">
              <h3 className="font-bold mb-2">Đăng ký hợp tác</h3>
              <label className="block text-sm mb-3">Tổ chức/Đơn vị
                <input required className="kb-focus mt-1 w-full border rounded-lg px-3 py-2" value={f.org} onChange={e=>setF({...f,org:e.target.value})}/>
              </label>
              <label className="block text-sm mb-3">Người liên hệ
                <input required className="kb-focus mt-1 w-full border rounded-lg px-3 py-2" value={f.contact} onChange={e=>setF({...f,contact:e.target.value})}/>
              </label>
              <label className="block text-sm mb-3">Đề xuất ngắn gọn
                <textarea required rows="4" className="kb-focus mt-1 w-full border rounded-lg px-3 py-2" value={f.proposal} onChange={e=>setF({...f,proposal:e.target.value})}></textarea>
              </label>
              <button className="kb-focus bg-kb-green text-white px-4 py-2 rounded-xl">Gửi đề xuất</button>
              {sent && <p className="text-sm text-kb-blue mt-2">Đã nhận thông tin! Chúng tôi sẽ phản hồi qua email.</p>}
            </form>
          </div>
        </Container>
      );
    };

    /** --------------------------
     * Footer
     * -------------------------- */
    const Footer = () => (
      <footer className="mt-12 border-t border-slate-200">
        <Container id="footer">
          <div className="grid md:grid-cols-3 gap-6 text-sm">
            <div>
              <div className="text-xl font-extrabold"><span className="text-kb-blue">KING</span><span className="text-kb-green">BULL</span></div>
              <p className="text-slate-600 mt-1">{COMPANY.slogan}</p>
            </div>
            <div>
              <p><b>Doanh nghiệp:</b> {COMPANY.name}</p>
              <p><b>MST:</b> {COMPANY.tax}</p>
              <p><b>Địa chỉ:</b> {COMPANY.address}</p>
            </div>
            <div>
              <p><b>Email:</b> {COMPANY.email}</p>
              <p><b>Điện thoại:</b> 0{COMPANY.phone}</p>
              <div className="mt-2 flex gap-2">
                <a className="kb-focus px-3 py-1 rounded-lg border" href={COMPANY.hotlineLink}>Hotline</a>
                <a className="kb-focus px-3 py-1 rounded-lg border" href={COMPANY.zaloLink} target="_blank" rel="noreferrer">Zalo OA</a>
              </div>
            </div>
          </div>
          <p className="text-xs text-slate-500 mt-6">© {(new Date()).getFullYear()} KINGBULL Việt Nam. All rights reserved.</p>
        </Container>
      </footer>
    );

    /** --------------------------
     * App (SPA tabs + sections)
     * -------------------------- */
    const App = () => {
      const [active, setActive] = useState("home");

      const scrollToMain = () => document.getElementById("main")?.focus();

      return (
        <div>
          <Navbar active={active} onChange={setActive} />
          <main id="main" tabIndex="-1">
            <Hero
              onSeeCases={() => setActive("cases")}
              onContact={() => setActive("support")}
            />
            {/* SPA tabs: render selected section prominently; other sections remain available for deep links */}
            <AnimatePresence mode="wait">
              {active==="home" && (
                <motion.div key="home" initial={{opacity:0, y:8}} animate={{opacity:1,y:0}} exit={{opacity:0,y:-8}}>
                  <CaseStudies />
                  <PDFLibrary />
                  <VideoSection />
                </motion.div>
              )}
              {active==="cases" && (
                <motion.div key="cases" initial={{opacity:0, y:8}} animate={{opacity:1,y:0}} exit={{opacity:0,y:-8}}>
                  <CaseStudies />
                </motion.div>
              )}
              {active==="library" && (
                <motion.div key="library" initial={{opacity:0, y:8}} animate={{opacity:1,y:0}} exit={{opacity:0,y:-8}}>
                  <PDFLibrary />
                </motion.div>
              )}
              {active==="videos" && (
                <motion.div key="videos" initial={{opacity:0, y:8}} animate={{opacity:1,y:0}} exit={{opacity:0,y:-8}}>
                  <VideoSection />
                </motion.div>
              )}
              {active==="dealer" && (
                <motion.div key="dealer" initial={{opacity:0, y:8}} animate={{opacity:1,y:0}} exit={{opacity:0,y:-8}}>
                  <DealerPortal />
                </motion.div>
              )}
              {active==="map" && (
                <motion.div key="map" initial={{opacity:0, y:8}} animate={{opacity:1,y:0}} exit={{opacity:0,y:-8}}>
                  <MapSupply />
                </motion.div>
              )}
              {active==="support" && (
                <motion.div key="support" initial={{opacity:0, y:8}} animate={{opacity:1,y:0}} exit={{opacity:0,y:-8}}>
                  <SupportPanel />
                </motion.div>
              )}
              {active==="logistics" && (
                <motion.div key="logistics" initial={{opacity:0, y:8}} animate={{opacity:1,y:0}} exit={{opacity:0,y:-8}}>
                  <LogisticsCalc />
                </motion.div>
              )}
              {active==="news" && (
                <motion.div key="news" initial={{opacity:0, y:8}} animate={{opacity:1,y:0}} exit={{opacity:0,y:-8}}>
                  <News />
                </motion.div>
              )}
              {active==="rd" && (
                <motion.div key="rd" initial={{opacity:0, y:8}} animate={{opacity:1,y:0}} exit={{opacity:0,y:-8}}>
                  <RDSection />
                </motion.div>
              )}
            </AnimatePresence>
          </main>
          <Footer />
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
