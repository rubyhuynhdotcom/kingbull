import React, { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';
import 'leaflet/dist/leaflet.css';
import L from 'leaflet';

// Import icons từ react-icons
import { FiHome, FiBriefcase, FiBookOpen, FiVideo, FiUsers, FiMap, FiPhoneCall, FiTool, FiRss, FiGitBranch, FiChevronDown, FiX, FiDownload, FiArrowRight, FiCheckCircle, FiLogIn, FiLogOut, FiLock, FiPhone, FiMail } from 'react-icons/fi';
import { FaZalo } from 'react-icons/fa';

// Fix lỗi icon mặc định của Leaflet
delete L.Icon.Default.prototype._getIconUrl;
L.Icon.Default.mergeOptions({
  iconRetinaUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png',
  iconUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png',
  shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
});


// DUMMY DATA (Dữ liệu mẫu)
//================================================================
const caseStudiesData = [
  { id: 1, image: 'https://via.placeholder.com/400x300.png/0EA4E8/FFFFFF?text=Ao+Nuôi+Cá+Tra', species: 'Cá Tra', area: '5,000 m²', duration: '8 tháng', output: '250 tấn', feedCost: '3.5 tỷ VNĐ', profit: '800 triệu VNĐ', roi: '22.8%', farmerQuote: 'Thức ăn Kingbull giúp cá lớn nhanh, FCR thấp, chất lượng thịt xuất khẩu rất tốt. Đội ngũ kỹ thuật hỗ trợ tận tình.', details: { video: 'https://www.youtube.com/embed/dQw4w9WgXcQ' } },
  { id: 2, image: 'https://via.placeholder.com/400x300.png/2BCB53/FFFFFF?text=Trại+Tôm+Thẻ', species: 'Tôm Thẻ Chân Trắng', area: '10,000 m²', duration: '4 tháng', output: '15 tấn', feedCost: '1.2 tỷ VNĐ', profit: '550 triệu VNĐ', roi: '45.8%', farmerQuote: 'Nhờ quy trình của Kingbull, vụ tôm vừa rồi thành công vượt mong đợi, không bị dịch bệnh, tôm đều size.', details: { video: 'https://www.youtube.com/embed/dQw4w9WgXcQ' } },
  { id: 3, image: 'https://via.placeholder.com/400x300.png/FFBE00/000000?text=Lồng+Bè+Cá+Diêu+Hồng', species: 'Cá Diêu Hồng', area: '2,000 m³', duration: '6 tháng', output: '50 tấn', feedCost: '900 triệu VNĐ', profit: '250 triệu VNĐ', roi: '27.7%', farmerQuote: 'Chất lượng nước ổn định, cá khỏe mạnh, màu sắc đẹp. Kingbull là đối tác tin cậy của chúng tôi.', details: { video: 'https://www.youtube.com/embed/dQw4w9WgXcQ' } },
];

const pdfLibraryData = [
  { id: 1, title: 'Tối ưu chỉ số FCR cho Cá Tra xuất khẩu', category: 'Cá Tra', topic: 'FCR', url: '#' },
  { id: 2, title: 'Quy trình phòng bệnh tổng hợp cho Tôm Thẻ', category: 'Tôm Thẻ', topic: 'Bệnh học', url: '#' },
  { id: 3, title: 'Quản lý môi trường nước ao nuôi công nghệ cao', category: 'Tổng hợp', topic: 'Môi trường', url: '#' },
  { id: 4, title: 'Tối ưu vòng quay vốn trong nuôi trồng thủy sản', category: 'Tổng hợp', topic: 'Tài chính', url: '#' },
];

const newsData = [
    { id: 1, title: 'Giá cá tra nguyên liệu tăng nhẹ', tag: 'Thị trường', date: '12/08/2025', excerpt: 'Giá cá tra tại ĐBSCL đang có xu hướng nhích nhẹ do nhu cầu từ các nhà máy chế biến xuất khẩu tăng...' },
    { id: 2, title: 'Xu hướng xuất khẩu thủy sản sang thị trường EU cuối năm 2025', tag: 'Xuất khẩu', date: '10/08/2025', excerpt: 'Các chuyên gia dự báo thị trường EU sẽ tăng cường nhập khẩu các sản phẩm giá trị gia tăng từ Việt Nam...' },
    { id: 3, title: 'Cảnh báo bệnh hoại tử gan tụy cấp trên tôm', tag: 'Dịch bệnh', date: '08/08/2025', excerpt: 'Bà con cần chú ý các biện pháp phòng ngừa và xử lý kịp thời khi phát hiện dấu hiệu bệnh...' },
];

const mapLocations = [
    { id: 1, position: [10.045162, 105.746857], name: 'Nhà máy chính Kingbull Cần Thơ', info: 'Năng lực sản xuất: 500,000 tấn/năm' },
    { id: 2, position: [10.7769, 106.7009], name: 'Kho trung chuyển TP.HCM', info: 'Thời gian giao hàng: 24h' },
    { id: 3, position: [9.5638, 105.7412], name: 'Kho khu vực Cà Mau', info: 'Thời gian giao hàng: 12h' },
];


// COMPONENTS
//================================================================

const SectionWrapper = ({ children, id }) => (
    <motion.section 
        id={id}
        className="py-16 md:py-24 px-4 md:px-8"
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.6 }}
    >
        {children}
    </motion.section>
);

const Navbar = ({ activeTab, setActiveTab, navItems }) => {
    const [isOpen, setIsOpen] = useState(false);

    return (
        <header className="sticky top-0 z-50 bg-white/80 backdrop-blur-lg shadow-md">
            <div className="container mx-auto px-4 md:px-8">
                <div className="flex items-center justify-between h-20">
                    <div className="font-display text-3xl font-bold text-kingbull-blue cursor-pointer" onClick={() => setActiveTab('home')}>
                        KINGBULL
                    </div>
                    <nav className="hidden lg:flex items-center space-x-2">
                        {navItems.map(item => (
                            <button
                                key={item.id}
                                onClick={() => setActiveTab(item.id)}
                                className={`px-3 py-2 rounded-md text-sm font-medium transition-colors duration-300 ${activeTab === item.id ? 'bg-kingbull-blue text-white shadow-sm' : 'text-dark-text hover:bg-kingbull-blue/10'}`}
                            >
                                {item.label}
                            </button>
                        ))}
                    </nav>
                    <div className="lg:hidden">
                        <button onClick={() => setIsOpen(!isOpen)} className="text-dark-text focus:outline-none">
                            {isOpen ? <FiX size={24} /> : <FiChevronDown size={24} />}
                        </button>
                    </div>
                </div>
            </div>
            {/* Mobile Menu */}
            <AnimatePresence>
                {isOpen && (
                    <motion.div
                        initial={{ opacity: 0, height: 0 }}
                        animate={{ opacity: 1, height: 'auto' }}
                        exit={{ opacity: 0, height: 0 }}
                        className="lg:hidden bg-white"
                    >
                        <nav className="flex flex-col px-4 pt-2 pb-4 space-y-1">
                            {navItems.map(item => (
                                <button
                                    key={item.id}
                                    onClick={() => {
                                        setActiveTab(item.id);
                                        setIsOpen(false);
                                    }}
                                    className={`block px-3 py-2 rounded-md text-base font-medium text-left ${activeTab === item.id ? 'bg-kingbull-blue text-white' : 'text-dark-text hover:bg-kingbull-blue/10'}`}
                                >
                                    {item.label}
                                </button>
                            ))}
                        </nav>
                    </motion.div>
                )}
            </AnimatePresence>
        </header>
    );
};

const Hero = ({ setActiveTab }) => (
    <section id="home" className="relative flex items-center justify-center h-[calc(100vh-80px)] text-white bg-gray-700">
        <div className="absolute inset-0 bg-black opacity-50"></div>
        {/* Placeholder cho video nền */}
        <video autoPlay loop muted className="absolute z-0 w-auto min-w-full min-h-full max-w-none">
            <source src="https://assets.mixkit.co/videos/preview/mixkit-flying-over-a-large-fish-farm-42217-large.mp4" type="video/mp4" />
            Your browser does not support the video tag.
        </video>
        <div className="relative z-10 text-center px-4">
            <h1 className="text-5xl md:text-7xl font-bold font-display text-kingbull-blue tracking-tight">KINGBULL</h1>
            <p className="mt-4 text-xl md:text-2xl font-light text-white drop-shadow-md">"Đột phá tăng trưởng, dẫn đầu lợi nhuận"</p>
            <div className="mt-10 flex flex-col md:flex-row items-center justify-center gap-4">
                <button onClick={() => setActiveTab('case-study')} className="bg-kingbull-blue hover:bg-kingbull-blue-dark text-white font-bold py-3 px-8 rounded-full transition duration-300 transform hover:scale-105 shadow-lg">
                    Xem Hồ sơ Dự án
                </button>
                <button onClick={() => setActiveTab('support')} className="bg-kingbull-gold hover:bg-kingbull-gold-dark text-dark-text font-bold py-3 px-8 rounded-full transition duration-300 transform hover:scale-105 shadow-lg">
                    Liên hệ Hợp tác
                </button>
            </div>
             <div className="mt-16 grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto">
                <div className="flex items-center gap-4 bg-white/10 backdrop-blur-sm p-4 rounded-lg">
                    <FiCheckCircle className="text-kingbull-green text-3xl"/>
                    <p className="text-left">Năng lực cung ứng quy mô lớn, ổn định.</p>
                </div>
                <div className="flex items-center gap-4 bg-white/10 backdrop-blur-sm p-4 rounded-lg">
                    <FiCheckCircle className="text-kingbull-green text-3xl"/>
                    <p className="text-left">Công thức tối ưu lợi nhuận, giảm FCR.</p>
                </div>
                <div className="flex items-center gap-4 bg-white/10 backdrop-blur-sm p-4 rounded-lg">
                    <FiCheckCircle className="text-kingbull-green text-3xl"/>
                    <p className="text-left">Hỗ trợ kỹ thuật chuyên sâu 24/7.</p>
                </div>
            </div>
        </div>
    </section>
);


const CaseStudyCard = ({ caseItem, onSelect }) => (
    <motion.div 
        className="bg-white rounded-lg shadow-lg overflow-hidden cursor-pointer group"
        onClick={() => onSelect(caseItem)}
        whileHover={{ y: -5, boxShadow: "0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)" }}
    >
        <div className="relative">
            <img src={caseItem.image} alt={caseItem.species} className="w-full h-48 object-cover"/>
            <div className="absolute inset-0 bg-black/30 group-hover:bg-black/10 transition-colors"></div>
            <span className="absolute top-2 right-2 bg-kingbull-gold text-dark-text text-xs font-bold px-2 py-1 rounded">{caseItem.species}</span>
        </div>
        <div className="p-4">
            <h3 className="font-bold text-lg text-dark-text">Lợi nhuận: {caseItem.profit}</h3>
            <p className="text-sm text-gray-600">Sản lượng: {caseItem.output}</p>
            <p className="text-sm text-gray-600">Thời gian nuôi: {caseItem.duration}</p>
            <div className="text-right mt-2 text-kingbull-blue font-semibold group-hover:underline">Xem chi tiết <FiArrowRight className="inline"/></div>
        </div>
    </motion.div>
);

const CaseStudyDetail = ({ caseItem, onBack }) => (
    <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className="bg-light-bg p-4 md:p-8 rounded-lg">
        <button onClick={onBack} className="mb-6 flex items-center text-kingbull-blue hover:underline font-semibold">
            <FiArrowRight className="transform rotate-180 mr-2"/> Quay lại danh sách
        </button>
        <div className="grid grid-cols-1 lg:grid-cols-5 gap-8">
            <div className="lg:col-span-3">
                <h2 className="text-3xl font-bold font-display text-dark-text mb-2">Dự án nuôi {caseItem.species}</h2>
                <div className="aspect-w-16 aspect-h-9 mb-4 rounded-lg overflow-hidden">
                    <iframe src={caseItem.details.video} title="YouTube video player" frameBorder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowFullScreen className="w-full h-full"></iframe>
                </div>
                <blockquote className="border-l-4 border-kingbull-gold italic p-4 bg-white my-4">
                    <p>"{caseItem.farmerQuote}"</p>
                    <cite className="block text-right mt-2 not-italic font-semibold">- Chủ trại</cite>
                </blockquote>
            </div>
            <div className="lg:col-span-2 bg-white p-6 rounded-lg shadow-sm">
                <h3 className="text-xl font-bold text-kingbull-blue mb-4 border-b pb-2">Dữ liệu & Hiệu quả</h3>
                <div className="space-y-3 text-dark-text">
                    <p><strong>Loài nuôi:</strong> {caseItem.species}</p>
                    <p><strong>Diện tích:</strong> {caseItem.area}</p>
                    <p><strong>Thời gian nuôi:</strong> {caseItem.duration}</p>
                    <p><strong>Sản lượng:</strong> <span className="font-bold text-kingbull-green">{caseItem.output}</span></p>
                    <p><strong>Chi phí thức ăn:</strong> {caseItem.feedCost}</p>
                    <p><strong>Lợi nhuận:</strong> <span className="font-bold text-kingbull-green">{caseItem.profit}</span></p>
                    <div className="text-center bg-kingbull-gold/20 p-4 rounded-lg mt-4">
                        <p className="text-lg font-bold">Tỷ suất Hoàn vốn (ROI)</p>
                        <p className="text-4xl font-bold text-kingbull-gold">{caseItem.roi}</p>
                    </div>
                </div>
            </div>
        </div>
    </motion.div>
);

const CaseStudy = () => {
    const [selectedCase, setSelectedCase] = useState(null);

    return (
        <SectionWrapper id="case-study">
            <div className="container mx-auto">
                 <AnimatePresence mode="wait">
                    {selectedCase ? (
                        <CaseStudyDetail key="detail" caseItem={selectedCase} onBack={() => setSelectedCase(null)} />
                    ) : (
                        <motion.div key="list" initial={{ opacity: 0 }} animate={{ opacity: 1 }}>
                            <h2 className="text-3xl md:text-4xl font-bold text-center text-dark-text font-display mb-12">Hồ Sơ Dự Án Thành Công</h2>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                                {caseStudiesData.map(c => <CaseStudyCard key={c.id} caseItem={c} onSelect={setSelectedCase} />)}
                            </div>
                        </motion.div>
                    )}
                </AnimatePresence>
            </div>
        </SectionWrapper>
    );
};

const PDFLibrary = () => (
    <SectionWrapper id="library" >
        <div className="container mx-auto text-center">
            <h2 className="text-3xl md:text-4xl font-bold text-dark-text font-display mb-12">Thư Viện Kỹ Thuật Chuyên Sâu</h2>
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                {pdfLibraryData.map(pdf => (
                    <a key={pdf.id} href={pdf.url} download className="block bg-white p-6 rounded-lg shadow-md hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                        <FiDownload className="text-kingbull-blue text-4xl mx-auto mb-4"/>
                        <h3 className="font-semibold text-dark-text mb-2">{pdf.title}</h3>
                        <div className="flex justify-center gap-2">
                           <span className="text-xs bg-kingbull-blue/20 text-kingbull-blue font-medium px-2 py-1 rounded-full">{pdf.category}</span>
                           <span className="text-xs bg-kingbull-green/20 text-kingbull-green font-medium px-2 py-1 rounded-full">{pdf.topic}</span>
                        </div>
                    </a>
                ))}
            </div>
        </div>
    </SectionWrapper>
);

const FactoryVideo = () => (
    <SectionWrapper id="factory" className="bg-light-bg">
        <div className="container mx-auto text-center">
            <h2 className="text-3xl md:text-4xl font-bold text-dark-text font-display mb-12">Quy Trình Sản Xuất & Năng Lực Nhà Máy</h2>
            <div className="aspect-w-16 aspect-h-9 mb-8 rounded-lg overflow-hidden shadow-2xl">
                 <iframe src="https://www.youtube.com/embed/SjgjRIwBtoA" title="Factory Video" frameBorder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowFullScreen className="w-full h-full"></iframe>
            </div>
             <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                <img src="https://via.placeholder.com/400x300.png?text=Dây+chuyền+1" alt="Production Line 1" className="rounded-lg shadow-md w-full h-full object-cover" />
                <img src="https://via.placeholder.com/400x300.png?text=Kho+lạnh" alt="Cold Storage" className="rounded-lg shadow-md w-full h-full object-cover" />
                <img src="https://via.placeholder.com/400x300.png?text=Container+xuất+hàng" alt="Export Container" className="rounded-lg shadow-md w-full h-full object-cover" />
                <img src="https://via.placeholder.com/400x300.png?text=Phòng+Lab" alt="Lab" className="rounded-lg shadow-md w-full h-full object-cover" />
            </div>
        </div>
    </SectionWrapper>
);

const DealerPortal = () => {
    const [isLoggedIn, setIsLoggedIn] = useState(false);

    const handleLogin = (e) => {
        e.preventDefault();
        // Mock login: chỉ cần set state là true
        setIsLoggedIn(true);
    };

    return (
        <SectionWrapper id="dealer">
            <div className="container mx-auto max-w-4xl text-center">
                <h2 className="text-3xl md:text-4xl font-bold text-dark-text font-display mb-4">Khu Vực Dành Cho Đại Lý & Trang Trại</h2>
                
                <AnimatePresence mode="wait">
                    {!isLoggedIn ? (
                        <motion.div key="login" initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="mt-8 bg-white p-8 rounded-xl shadow-lg border">
                            <FiLock className="text-kingbull-gold text-5xl mx-auto mb-4"/>
                            <p className="text-gray-600 mb-6">Vui lòng đăng nhập để truy cập tài liệu nội bộ.</p>
                            <form onSubmit={handleLogin} className="max-w-sm mx-auto">
                                <input type="email" placeholder="Email đăng nhập" className="w-full px-4 py-2 border rounded-md mb-4 focus:ring-kingbull-blue focus:border-kingbull-blue" defaultValue="daily@kingbull.com.vn" />
                                <input type="password" placeholder="Mật khẩu" className="w-full px-4 py-2 border rounded-md mb-6 focus:ring-kingbull-blue focus:border-kingbull-blue" defaultValue="password" />
                                <button type="submit" className="w-full bg-kingbull-blue hover:bg-kingbull-blue-dark text-white font-bold py-3 px-6 rounded-lg transition duration-300 flex items-center justify-center gap-2">
                                    <FiLogIn /> Đăng Nhập
                                </button>
                            </form>
                        </motion.div>
                    ) : (
                        <motion.div key="content" initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="mt-8 bg-white p-8 rounded-xl shadow-lg border">
                             <div className="flex justify-between items-center mb-6">
                                <h3 className="text-2xl font-bold text-kingbull-green">Chào mừng Đại lý!</h3>
                                <button onClick={() => setIsLoggedIn(false)} className="text-sm text-red-500 hover:underline flex items-center gap-1">
                                    <FiLogOut /> Đăng xuất
                                </button>
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 text-left">
                                <a href="#" download className="block p-4 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors">
                                    <h4 className="font-bold text-blue-800">Bảng giá số lượng lớn</h4>
                                    <p className="text-sm text-blue-600">Cập nhật tháng 08/2025</p>
                                </a>
                                <a href="#" download className="block p-4 bg-green-50 hover:bg-green-100 rounded-lg transition-colors">
                                    <h4 className="font-bold text-green-800">Chính sách chiết khấu</h4>
                                    <p className="text-sm text-green-600">Áp dụng từ Q3/2025</p>
                                </a>
                                <a href="#" download className="block p-4 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition-colors">
                                    <h4 className="font-bold text-yellow-800">Tài liệu huấn luyện kỹ thuật</h4>
                                    <p className="text-sm text-yellow-600">Video & PDF</p>
                                </a>
                                <a href="#" download className="block p-4 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors">
                                    <h4 className="font-bold text-gray-800">Mẫu Hợp đồng phân phối</h4>
                                    <p className="text-sm text-gray-600">Bản template</p>
                                </a>
                            </div>
                        </motion.div>
                    )}
                </AnimatePresence>
            </div>
        </SectionWrapper>
    );
};


const SupplyMap = () => (
    <SectionWrapper id="map">
        <div className="container mx-auto">
            <h2 className="text-3xl md:text-4xl font-bold text-center text-dark-text font-display mb-12">Bản Đồ Năng Lực Cung Ứng</h2>
            <div className="h-[500px] w-full rounded-lg shadow-xl overflow-hidden">
                <MapContainer center={[10.045, 105.746]} zoom={8} scrollWheelZoom={false} style={{ height: '100%', width: '100%' }}>
                    <TileLayer
                        attribution='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                        url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
                    />
                    {mapLocations.map(loc => (
                         <Marker key={loc.id} position={loc.position}>
                            <Popup>
                                <strong className="text-kingbull-blue">{loc.name}</strong><br/>{loc.info}
                            </Popup>
                        </Marker>
                    ))}
                </MapContainer>
            </div>
        </div>
    </SectionWrapper>
);

const Support = () => (
    <SectionWrapper id="support" className="bg-light-bg">
        <div className="container mx-auto">
            <h2 className="text-3xl md:text-4xl font-bold text-center text-dark-text font-display mb-12">Hỗ Trợ Kỹ Thuật 24/7</h2>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-5xl mx-auto">
                <a href="tel:0587085649" className="text-center bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300">
                    <FiPhoneCall className="text-kingbull-green text-6xl mx-auto mb-4"/>
                    <h3 className="text-xl font-bold text-dark-text">Gọi Hotline Kỹ Thuật</h3>
                    <p className="text-2xl font-semibold text-kingbull-green mt-2">058.708.5649</p>
                    <p className="text-sm text-gray-500 mt-1">Sẵn sàng hỗ trợ 24/7</p>
                </a>
                 <a href="https://zalo.me/your-zalo-oa" target="_blank" rel="noopener noreferrer" className="text-center bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300">
                    <FaZalo className="text-blue-500 text-6xl mx-auto mb-4"/>
                    <h3 className="text-xl font-bold text-dark-text">Chat Zalo OA</h3>
                    <p className="text-kingbull-blue mt-2 font-semibold">Kingbull Việt Nam OA</p>
                    <p className="text-sm text-gray-500 mt-1">Phản hồi trong vài phút</p>
                </a>
                <div className="text-center bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300">
                    <FiMail className="text-kingbull-gold text-6xl mx-auto mb-4"/>
                    <h3 className="text-xl font-bold text-dark-text">Đặt Lịch Hẹn Chuyên Gia</h3>
                    <p className="text-gray-600 mt-2">Điền form để chúng tôi liên hệ và sắp xếp chuyên gia phù hợp.</p>
                     <button className="mt-4 bg-kingbull-gold text-dark-text font-bold py-2 px-4 rounded-lg">
                        Điền Form
                    </button>
                </div>
            </div>
        </div>
    </SectionWrapper>
);

const LogisticsCalc = () => {
    const [result, setResult] = useState('');

    const handleCalculate = (e) => {
        e.preventDefault();
        const quantity = e.target.elements.quantity.value;
        const location = e.target.elements.location.value;

        if(!quantity || !location) {
            setResult('<p class="text-red-500">Vui lòng nhập đầy đủ thông tin.</p>');
            return;
        }

        // Mock calculation
        const containers = Math.ceil(quantity / 20);
        const time = location === 'can-tho' ? '1 ngày' : (location === 'hcm' ? '2 ngày' : '3 ngày');
        const warehouse = location === 'can-tho' ? 'Nhà máy chính Cần Thơ' : 'Kho trung chuyển TP.HCM';

        setResult(`
            <h4 class="font-bold text-lg text-kingbull-blue mb-2">Kết quả mô phỏng:</h4>
            <p><strong>Số chuyến container (20 tấn/cont):</strong> ${containers} chuyến</p>
            <p><strong>Thời gian giao hàng dự kiến:</strong> ${time}</p>
            <p><strong>Kho xuất phát:</strong> ${warehouse}</p>
        `);
    }

    return (
        <SectionWrapper id="logistics">
            <div className="container mx-auto">
                <h2 className="text-3xl md:text-4xl font-bold text-center text-dark-text font-display mb-12">Công Cụ Tính Toán Logistics & Kho Bãi</h2>
                <div className="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8 bg-white p-8 rounded-xl shadow-lg border">
                    <form onSubmit={handleCalculate}>
                        <h3 className="text-xl font-bold text-dark-text mb-4">Thông tin đơn hàng</h3>
                        <div className="mb-4">
                            <label htmlFor="quantity" className="block text-gray-700 font-semibold mb-2">Số lượng sản phẩm cần (tấn)</label>
                            <input type="number" id="quantity" name="quantity" className="w-full px-4 py-2 border rounded-md focus:ring-kingbull-blue focus:border-kingbull-blue" placeholder="VD: 50" />
                        </div>
                        <div className="mb-6">
                            <label htmlFor="location" className="block text-gray-700 font-semibold mb-2">Địa điểm giao hàng</label>
                            <select id="location" name="location" className="w-full px-4 py-2 border rounded-md focus:ring-kingbull-blue focus:border-kingbull-blue bg-white">
                                <option value="can-tho">Tại Cần Thơ</option>
                                <option value="hcm">TP. Hồ Chí Minh</option>
                                <option value="ca-mau">Cà Mau</option>
                                <option value="khac">Khu vực khác</option>
                            </select>
                        </div>
                        <button type="submit" className="w-full bg-kingbull-green hover:bg-kingbull-green-dark text-white font-bold py-3 px-6 rounded-lg transition duration-300 flex items-center justify-center gap-2">
                           <FiTool/> Tính toán mô phỏng
                        </button>
                    </form>
                    <div className="bg-light-bg p-6 rounded-lg">
                        {result ? (
                             <div dangerouslySetInnerHTML={{ __html: result }}></div>
                        ) : (
                             <div className="text-center text-gray-500 flex flex-col items-center justify-center h-full">
                                <FiArrowRight className="text-4xl mb-2"/>
                                <p>Kết quả sẽ hiển thị ở đây.</p>
                             </div>
                        )}
                    </div>
                </div>
            </div>
        </SectionWrapper>
    )
};


const News = () => (
    <SectionWrapper id="news" className="bg-light-bg">
        <div className="container mx-auto">
            <h2 className="text-3xl md:text-4xl font-bold text-center text-dark-text font-display mb-12">Tin Tức Ngành & Phân Tích Thị Trường</h2>
             <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                {newsData.map(item => (
                    <div key={item.id} className="bg-white rounded-lg shadow-md overflow-hidden flex flex-col">
                        <div className="p-6 flex-grow">
                            <div className="flex justify-between items-center mb-2">
                                <span className="text-xs bg-kingbull-gold text-dark-text font-bold px-2 py-1 rounded">{item.tag}</span>
                                <span className="text-xs text-gray-500">{item.date}</span>
                            </div>
                            <h3 className="font-bold text-lg text-dark-text mb-2">{item.title}</h3>
                            <p className="text-gray-600 text-sm">{item.excerpt}</p>
                        </div>
                        <div className="p-6 pt-0">
                           <a href="#" className="font-semibold text-kingbull-blue hover:underline">Đọc thêm <FiArrowRight className="inline"/></a>
                        </div>
                    </div>
                ))}
            </div>
        </div>
    </SectionWrapper>
);

const RDSection = () => (
    <SectionWrapper id="rd">
         <div className="container mx-auto text-center max-w-4xl">
            <FiGitBranch className="text-kingbull-blue text-6xl mx-auto mb-4"/>
            <h2 className="text-3xl md:text-4xl font-bold text-dark-text font-display mb-4">Chương Trình Hợp Tác R&D</h2>
            <p className="text-lg text-gray-600 mb-8">
                Kingbull luôn tiên phong trong nghiên cứu và phát triển, hợp tác chặt chẽ với các viện nghiên cứu, trường đại học và các trại nuôi thử nghiệm để tạo ra những sản phẩm đột phá, mang lại hiệu quả bền vững cho ngành thủy sản Việt Nam.
            </p>
            <button className="bg-kingbull-blue hover:bg-kingbull-blue-dark text-white font-bold py-3 px-8 rounded-full transition duration-300 transform hover:scale-105 shadow-lg">
                Đăng ký Hợp tác Nghiên cứu
            </button>
        </div>
    </SectionWrapper>
);


const Footer = () => (
    <footer className="bg-dark-text text-white">
        <div className="container mx-auto py-12 px-8">
            <div className="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 className="text-2xl font-bold font-display text-kingbull-blue">KINGBULL VIỆT NAM</h3>
                    <p className="text-sm mt-2 text-gray-300">"Đột phá tăng trưởng, dẫn đầu lợi nhuận"</p>
                </div>
                 <div>
                    <h4 className="font-bold text-lg mb-4">Thông tin liên hệ</h4>
                    <p className="text-sm text-gray-400 mb-2"><strong>MST:</strong> 1801608521</p>
                    <p className="text-sm text-gray-400 mb-2"><strong>Địa chỉ:</strong> Tầng 6, số 41, CMT8, P. Cái Khế, TP Cần Thơ</p>
                    <p className="text-sm text-gray-400 mb-2"><strong>Email:</strong> admin@kingbull.com.vn</p>
                    <p className="text-sm text-gray-400 mb-2"><strong>Hotline:</strong> 058.708.5649</p>
                </div>
                <div>
                     <h4 className="font-bold text-lg mb-4">Liên kết nhanh</h4>
                     <ul className="space-y-2 text-sm">
                        <li><a href="#case-study" className="text-gray-400 hover:text-white">Dự án thành công</a></li>
                        <li><a href="#library" className="text-gray-400 hover:text-white">Thư viện kỹ thuật</a></li>
                        <li><a href="#dealer" className="text-gray-400 hover:text-white">Cổng thông tin đại lý</a></li>
                        <li><a href="#support" className="text-gray-400 hover:text-white">Hỗ trợ 24/7</a></li>
                     </ul>
                </div>
                 <div>
                     <h4 className="font-bold text-lg mb-4">Kết nối với chúng tôi</h4>
                     <div className="flex space-x-4">
                        {/* Add social media links here */}
                     </div>
                </div>
            </div>
             <div className="mt-8 pt-8 border-t border-gray-700 text-center text-sm text-gray-500">
                <p>&copy; {new Date().getFullYear()} CÔNG TY TNHH KINGBULL VIỆT NAM. All Rights Reserved.</p>
            </div>
        </div>
    </footer>
);


// MAIN APP COMPONENT
//================================================================
export default function App() {
    const [activeTab, setActiveTab] = useState('home');

    const navItems = [
        { id: 'home', label: 'Trang chủ', icon: <FiHome/>, component: <Hero setActiveTab={setActiveTab} /> },
        { id: 'case-study', label: 'Case Study', icon: <FiBriefcase/>, component: <CaseStudy /> },
        { id: 'library', label: 'Thư viện', icon: <FiBookOpen/>, component: <PDFLibrary /> },
        { id: 'factory', label: 'Nhà máy', icon: <FiVideo/>, component: <FactoryVideo /> },
        { id: 'dealer', label: 'Đại lý', icon: <FiUsers/>, component: <DealerPortal /> },
        { id: 'map', label: 'Cung ứng', icon: <FiMap/>, component: <SupplyMap /> },
        { id: 'support', label: 'Hỗ trợ 24/7', icon: <FiPhoneCall/>, component: <Support /> },
        { id: 'logistics', label: 'Logistics', icon: <FiTool/>, component: <LogisticsCalc /> },
        { id: 'news', label: 'Tin tức', icon: <FiRss/>, component: <News /> },
        { id: 'rd', label: 'Hợp tác R&D', icon: <FiGitBranch/>, component: <RDSection /> },
    ];
    
    // Scroll to section when tab changes
    useEffect(() => {
        const element = document.getElementById(activeTab);
        if (element) {
            // Add a slight offset to account for the sticky navbar height
            const offset = 80; 
            const bodyRect = document.body.getBoundingClientRect().top;
            const elementRect = element.getBoundingClientRect().top;
            const elementPosition = elementRect - bodyRect;
            const offsetPosition = elementPosition - offset;

            window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
            });
        }
    }, [activeTab]);


    const CurrentComponent = navItems.find(item => item.id === activeTab)?.component;

    return (
        <div className="bg-light-bg font-sans text-dark-text">
            <Navbar activeTab={activeTab} setActiveTab={setActiveTab} navItems={navItems.map(({ id, label }) => ({ id, label }))} />
            <main>
                {/* The Hero component is handled separately due to its full-screen nature */}
                {activeTab === 'home' ? <Hero setActiveTab={setActiveTab} /> : navItems.find(item => item.id === activeTab)?.component}
            </main>
            <Footer />
        </div>
    );
}
